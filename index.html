<!DOCTYPE html>
<html>
  <head>
    <title>Hola</title>
  </head>
  <body>ß
    <h1>Hola soy Rudo Zan! </h1>
    <p>Con SupaBase</p>
    <button onclick="generarYGuardar()">Generar código</button>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
    // Initialize Supabase client
    const supabaseUrl = 'https://junonydusnrcumbjjzqt.supabase.co';
    const supabaseKey = 'R6rvUOl2IbzJIytl'; // Replace with your actual public key
    const { createClient } = supabase;
    const supabase = createClient(supabaseUrl, supabaseKey);

    // Función para generar y guardar
    async function generarYGuardar() {
        const codigo = Math.floor(Math.random() * 9000) + 1000;

        try {
            const { data, error } = await supabase
                .from('codigos')
                .insert([
                    { 
                        valor: codigo,
                        timestamp: new Date().toISOString()
                    }
                ]);

            if (error) throw error;
            alert("Código generado y guardado: " + codigo);
        } catch (e) {
            console.error("Error al guardar:", e);
            alert("Error al guardar el código.");
        }
    }
    </script>

  </body>
  
</html>